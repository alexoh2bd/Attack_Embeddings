[11:37:45] STARTING SCRIPT
[11:37:45] Initializing Trainer on cuda
[11:37:45] Loading OpenAI CLIP model: ViT-L/14...
[11:37:50] Model loaded.
[11:37:50] Freezing non-visual parameters...
[11:37:50] Optimizer initialized.
[11:37:50] Loading dataset MSCOCO_i2t...
[11:37:52] Dataset loaded. Size: 1000
[11:37:52] Training Configuration:
[11:37:52]   Effective Batch Size: 16
[11:37:52]   Micro Batch Size:     2
[11:37:52]   Accumulation Steps:   8
[11:37:52]   Max Steps:            1000
[11:37:52] Starting Epoch 1

Processing micro-batch 1... (Accumulating 1/8)Traceback (most recent call last):
  File "/home/gss/duke/Attack_Embeddings/defend_clip_mat.py", line 294, in <module>
    main()
  File "/home/gss/duke/Attack_Embeddings/defend_clip_mat.py", line 284, in main
    trainer.train(
  File "/home/gss/duke/Attack_Embeddings/defend_clip_mat.py", line 252, in train
    del image_input, text_input, image_features, text_features, logits_per_image, logits_per_text, loss
        ^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'image_input' where it is not associated with a value
